var e=Object.defineProperty,s=Object.defineProperties,t=Object.getOwnPropertyDescriptors,r=Object.getOwnPropertySymbols,a=Object.prototype.hasOwnProperty,o=Object.prototype.propertyIsEnumerable,n=(s,t,r)=>t in s?e(s,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):s[t]=r,i=(e,s)=>{for(var t in s||(s={}))a.call(s,t)&&n(e,t,s[t]);if(r)for(var t of r(s))o.call(s,t)&&n(e,t,s[t]);return e},l=(e,r)=>s(e,t(r)),c=(e,s,t)=>new Promise(((r,a)=>{var o=e=>{try{i(t.next(e))}catch(s){a(s)}},n=e=>{try{i(t.throw(e))}catch(s){a(s)}},i=e=>e.done?r(e.value):Promise.resolve(e.value).then(o,n);i((t=t.apply(e,s)).next())}));import{r as d,u,j as m,F as p,a as w,b as h,L as j,H as g,c as x,k as y,d as f,e as b,f as v,G as k,g as z,h as S,i as N,l as E,m as P}from"./vendor-react-BdIbG8GJ.js";import{P as M,C as I,A as C,S as A,F as L,E as _,a as O,B as T,b as W,c as B,d as H}from"./app-components-D-uSeCsa.js";import{P as R,T as U,M as F,C as $,a as G,S as q,b as J,W as Z,G as V,A as D,z as X,t as Y}from"./vendor-other-emba8bVk.js";import{m as K,A as Q}from"./vendor-framer-motion-1lk-eln3.js";const ee={},se=function(e,s,t){let r=Promise.resolve();if(s&&s.length>0){document.getElementsByTagName("link");const e=document.querySelector("meta[property=csp-nonce]"),t=(null==e?void 0:e.nonce)||(null==e?void 0:e.getAttribute("nonce"));r=Promise.allSettled(s.map((e=>{if((e=function(e){return"/"+e}(e))in ee)return;ee[e]=!0;const s=e.endsWith(".css"),r=s?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${e}"]${r}`))return;const a=document.createElement("link");return a.rel=s?"stylesheet":"modulepreload",s||(a.as="script"),a.crossOrigin="",a.href=e,t&&a.setAttribute("nonce",t),document.head.appendChild(a),s?new Promise(((s,t)=>{a.addEventListener("load",s),a.addEventListener("error",(()=>t(new Error(`Unable to preload CSS for ${e}`))))})):void 0})))}function a(e){const s=new Event("vite:preloadError",{cancelable:!0});if(s.payload=e,window.dispatchEvent(s),!s.defaultPrevented)throw e}return r.then((s=>{for(const e of s||[])"rejected"===e.status&&a(e.reason);return e().catch(a)}))},te="https://codelinesjs.pl/api/",re={request(e){return c(this,arguments,(function*(e,s={}){var t,r;try{const{method:o="GET",headers:n={},body:l,requiresAuth:c=!1}=s,d=`${te.replace("www.","")}${e}`,u=i({"Content-Type":"application/json",Accept:"application/json"},n);if(c){const e=localStorage.getItem("token")||sessionStorage.getItem("token");e&&(u.Authorization=`Bearer ${e}`)}const m={method:o,headers:u,mode:"cors",credentials:"include"};l&&(m.body=JSON.stringify(l));const p=yield fetch(d,m);let w=null,h=null;try{const e=yield p.text();e&&(w=JSON.parse(e))}catch(a){h="Nieprawidłowa odpowiedź serwera"}if(w){if("success"===w.status)return{data:w.data,error:null,status:w.code||p.status};if("fail"===w.status||"error"===w.status)return h=w.message||(null==(r=null==(t=w.errors)?void 0:t[0])?void 0:r.message)||`Błąd: ${w.status}`,{data:null,error:h,status:w.code||p.status};if(w.error)return{data:null,error:w.error,status:p.status};if(w.token)return{data:w,error:null,status:p.status}}return p.ok||h?{data:(null==w?void 0:w.data)||w,error:h,status:p.status}:(h=`Błąd ${p.status}: ${p.statusText}`,{data:null,error:h,status:p.status})}catch(a){return{data:null,error:a instanceof Error?(e=>{const s=e.message.toLowerCase();return s.includes("failed to fetch")?"Nie można połączyć się z serwerem. Sprawdź swoje połączenie internetowe.":s.includes("network request failed")?"Błąd połączenia sieciowego. Sprawdź swoje połączenie internetowe.":s.includes("timeout")?"Przekroczono czas oczekiwania na odpowiedź serwera.":s.includes("abort")?"Żądanie zostało przerwane.":s.includes("cors")?"Błąd polityki CORS. Brak dostępu do zasobu z tej domeny.":e.message})(a):"Nieznany błąd zapytania",status:0}}}))},get(e){return c(this,arguments,(function*(e,s={}){return this.request(e,l(i({},s),{method:"GET"}))}))},post(e,s){return c(this,arguments,(function*(e,s,t={}){return this.request(e,l(i({},t),{method:"POST",body:s}))}))},put(e,s){return c(this,arguments,(function*(e,s,t={}){return this.request(e,l(i({},t),{method:"PUT",body:s}))}))},delete(e){return c(this,arguments,(function*(e,s={}){return this.request(e,l(i({},s),{method:"DELETE"}))}))},patch(e,s){return c(this,arguments,(function*(e,s,t={}){return this.request(e,l(i({},t),{method:"PATCH",body:s}))}))}},ae=e=>{const s=(e=>{const s=u(),{setLoading:t,setError:r,setIsAuthenticated:a,setUser:o}=e;return(e,n,i=!1)=>c(void 0,null,(function*(){try{t(!0),r(null);const l=yield re.post("auth/login",{email:e,password:n,rememberMe:i});if(l.error)throw new Error(l.error);if(!l.data)throw new Error("Nieznany błąd logowania. Spróbuj ponownie później.");const{token:c,user:d}=l.data;localStorage.removeItem("token"),sessionStorage.removeItem("token"),i?localStorage.setItem("token",c):sessionStorage.setItem("token",c),o(d),a(!0),s("/dashboard")}catch(l){const e=l instanceof Error?l.message:"Wystąpił błąd podczas logowania";r(e),a(!1)}finally{t(!1)}}))})(e),t=(e=>{const s=u(),{setLoading:t,setError:r,setIsAuthenticated:a,setUser:o}=e;return(e,n,i)=>c(void 0,null,(function*(){try{t(!0),r(null);const l=yield re.post("auth/register",{email:e,password:n,username:i});if(l.error){if(l.error.includes("już istnieje"))throw r("Użytkownik o podanym adresie email lub nazwie użytkownika już istnieje w systemie"),new Error("Użytkownik o podanym adresie email lub nazwie użytkownika już istnieje w systemie");throw r(l.error),new Error(l.error)}if(!l.data){const e="Nieznany błąd rejestracji. Spróbuj ponownie później.";throw r(e),new Error(e)}const{token:c,user:d}=l.data;localStorage.removeItem("token"),sessionStorage.removeItem("token"),sessionStorage.setItem("token",c),o&&d&&o(d),a(!0),s("/dashboard")}catch(l){const e=l instanceof Error?l.message:"Wystąpił błąd podczas rejestracji";r(e),a(!1)}finally{t(!1)}}))})(e),r=(e=>{const{setLoading:s,setError:t}=e;return e=>c(void 0,null,(function*(){var r;try{s(!0),t(null);const a=yield re.post("auth/forgot-password",{email:e});if(a.error)throw new Error(a.error);return(null==(r=a.data)?void 0:r.message)||"Link do resetowania hasła został wysłany na Twój adres email."}catch(a){if(a instanceof Error)throw t(a.message),a;{const e="Wystąpił błąd podczas wysyłania linku resetującego hasło";throw t(e),new Error(e)}}finally{s(!1)}}))})(e),a=(e=>{const s=u(),{setLoading:t,setIsAuthenticated:r,setUser:a}=e;return()=>{try{t(!0),localStorage.removeItem("token"),sessionStorage.removeItem("token"),a&&a(null),r(!1),s("/")}finally{t(!1)}}})(e),o=(e=>{const s=u(),{setLoading:t,setError:r,setIsAuthenticated:a,setUser:o}=e;return(e,n=!1)=>c(void 0,null,(function*(){try{if(t(!0),r(null),!e.credential)return r("Nie udało się uzyskać tokenu uwierzytelniającego z Google. Spróbuj ponownie."),void a(!1);const i=yield re.post("auth/google-login",{credential:e.credential,rememberMe:n});if(i.error)throw new Error(i.error);if(!i.data)throw new Error("Nieznany błąd logowania przez Google. Spróbuj ponownie później.");const l=i.data.data,c=l.token,d=l.user||l.user&&l.user.user;n?localStorage.setItem("token",c):sessionStorage.setItem("token",c),o&&o(d),a(!0),s("/dashboard")}catch(i){const e=i instanceof Error?i.message:"Wystąpił błąd podczas logowania przez Google";r(e),a(!1)}finally{t(!1)}}))})(e),n=(e=>{const s=u(),{setLoading:t,setError:r}=e;return(e,a,o)=>c(void 0,null,(function*(){var n;try{if(!e||e.length<10)throw new Error("Nieprawidłowy token resetowania hasła. Sprawdź, czy link jest poprawny.");if(a!==o)throw new Error("Hasła nie są identyczne. Upewnij się, że oba pola zawierają to samo hasło.");t(!0),r(null);const i=yield re.post("auth/reset-password",{token:e,password:a,confirmPassword:o});if(i.error)throw new Error(i.error);return setTimeout((()=>{s("/logowanie")}),3e3),(null==(n=i.data)?void 0:n.message)||"Hasło zostało pomyślnie zmienione. Za chwilę zostaniesz przekierowany do strony logowania."}catch(i){if(i instanceof Error)throw r(i.message),i;{const e="Wystąpił nieznany błąd podczas resetowania hasła";throw r(e),new Error(e)}}finally{t(!1)}}))})(e);return{login:s,register:t,forgotPassword:r,logout:a,loginWithGoogle:o,resetPassword:n}},oe=()=>{const e=(()=>{const[e,s]=d.useState(!1),[t,r]=d.useState(null),[a,o]=d.useState(!1),[n,i]=d.useState(!0),[l,c]=d.useState(null);return{loading:e,setLoading:s,error:t,setError:r,isAuthenticated:a,setIsAuthenticated:o,isLoading:n,setIsLoading:i,user:l,setUser:c}})(),s=ae(e),t=u(),[r,a]=d.useState(!0);d.useEffect((()=>{c(void 0,null,(function*(){try{a(!0);const t=localStorage.getItem("token")||sessionStorage.getItem("token");if(!t)return void e.setIsAuthenticated(!1);if("string"!=typeof t||t.length<10)return localStorage.removeItem("token"),sessionStorage.removeItem("token"),void e.setIsAuthenticated(!1);const r=te.replace("www.",""),o=yield fetch(`${r}auth/verify`,{method:"GET",headers:{Authorization:`Bearer ${t}`,Accept:"application/json"},mode:"cors",credentials:"include"});if(429===o.status)throw new Error("Zbyt wiele prób weryfikacji. Spróbuj ponownie za chwilę.");let n,i="";try{if(i=yield o.text(),!i)throw new Error("Pusta odpowiedź serwera");n=JSON.parse(i)}catch(s){throw new Error("Nieprawidłowa odpowiedź serwera: "+s)}if("success"===(null==n?void 0:n.status)&&(null==n?void 0:n.data))return e.setUser(n.data.user||n.data),void e.setIsAuthenticated(!0);if(!o.ok)throw new Error((null==n?void 0:n.error)||(null==n?void 0:n.message)||"Nieznany błąd weryfikacji tokenu");if(!(null==n?void 0:n.user))throw new Error("Odpowiedź API nie zawiera danych użytkownika");e.setUser(n.user),e.setIsAuthenticated(!0)}catch(t){e.setError(t instanceof Error?t.message:"Wystąpił błąd podczas weryfikacji tokenu"),e.setIsAuthenticated(!1),localStorage.removeItem("token"),sessionStorage.removeItem("token")}finally{a(!1)}}))}),[]);const o=l(i({},e),{isAuthChecking:r,token:localStorage.getItem("token")||sessionStorage.getItem("token")});return l(i(i({},o),s),{logout:()=>{localStorage.removeItem("token"),sessionStorage.removeItem("token"),e.setIsAuthenticated(!1),e.setUser(null),t("/")}})},ne=()=>{const e=d.useRef(null),s=(e=>{const s=d.useRef(null),t=d.useRef({x:0,y:0}),r=d.useRef(),a=d.useMemo((()=>100),[]),o=d.useMemo((()=>[new R("#f7df1e",2),new R("#f7df1e",2),new R("#f7df1e",2)]),[]),n=d.useCallback((()=>{const e=new U(.5,0),s=new F({color:new $("#f7df1e").multiplyScalar(.5),emissive:new $("#f7df1e").multiplyScalar(.3),emissiveIntensity:.5,transparent:!0,opacity:.8,shininess:90});return new G(e,s)}),[]),i=d.useCallback((s=>{var r;const a=null==(r=e.current)?void 0:r.getBoundingClientRect();a&&(t.current={x:(s.clientX-a.left)/a.width*2-1,y:-(s.clientY-a.top)/a.height*2+1})}),[]),l=d.useCallback(((s,t)=>{if(!e.current)return;const{width:r,height:a}=e.current.getBoundingClientRect();s.setSize(r,a),t.aspect=r/a,t.updateProjectionMatrix()}),[]);return d.useEffect((()=>{if(!s.current||!e.current)return;const c=new q,d=new J(75,1,.1,1e3),u=new Z({canvas:s.current,alpha:!0,antialias:!0,powerPreference:"high-performance"});u.setClearColor(0,0);const m=new V,p=[];for(let e=0;e<a;e++){const e=n();e.position.set(50*(Math.random()-.5),50*(Math.random()-.5),50*(Math.random()-.5)),e.rotation.set(Math.random()*Math.PI,Math.random()*Math.PI,Math.random()*Math.PI),p.push(e),m.add(e)}c.add(m),o.forEach(((e,s)=>{e.position.set(30*Math.cos(s*Math.PI*2/3),30*Math.sin(s*Math.PI*2/3),15),c.add(e)})),c.add(new D("#ffffff",.5)),d.position.z=30;const w=()=>{r.current=requestAnimationFrame(w),p.forEach(((e,s)=>{const t=.001*Date.now()+s;e.position.y+=.02*Math.sin(.5*t),e.rotation.x+=.01,e.rotation.y+=.01,e.rotation.z+=.01})),m.rotation.y+=.001,m.rotation.x=.2*t.current.y,m.rotation.z=.2*t.current.x,u.render(c,d)},h=()=>l(u,d);return window.addEventListener("mousemove",i),window.addEventListener("resize",h),h(),w(),()=>{r.current&&cancelAnimationFrame(r.current),window.removeEventListener("mousemove",i),window.removeEventListener("resize",h),u.dispose(),c.clear()}}),[a,o,n,i,l]),s})(e);return m.jsxs(m.Fragment,{children:[m.jsx(K.div,{ref:e,initial:{opacity:0},animate:{opacity:.3},className:"absolute inset-0 pointer-events-none",children:m.jsx("canvas",{ref:s,className:"w-full h-full"})}),m.jsxs("div",{className:"absolute top-0 left-0 w-full h-full overflow-hidden pointer-events-none",children:[m.jsx("div",{className:"absolute -top-20 -left-20 w-96 h-96 bg-[#f7df1e]/10 rounded-full blur-3xl"}),m.jsx("div",{className:"absolute -bottom-40 -right-20 w-[30rem] h-[30rem] bg-[#f7df1e]/5 rounded-full blur-3xl"}),m.jsx("div",{className:"absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 w-[40rem] h-[40rem] bg-[#1a1a1a]/50 rounded-full blur-3xl"}),m.jsx("div",{className:"absolute inset-0 bg-[url('/grid-pattern.svg')] bg-center opacity-5"}),m.jsx("div",{className:"absolute inset-0 bg-gradient-to-b from-[#1a1a1a]/0 via-[#1a1a1a]/0 to-[#1a1a1a]/80"})]})]})},ie=()=>m.jsx("div",{className:"hidden md:block",children:m.jsx(M,{position:"left",title:"CodeLinesJS App",className:"transform scale-90"})}),le=({text:e})=>m.jsx("div",{className:"flex items-center justify-center md:justify-start bg-[#f7df1e]/10 rounded-lg p-3",children:m.jsxs("span",{className:"text-[#f7df1e] font-medium",children:["✓ ",e]})}),ce=()=>m.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[m.jsx(le,{text:"Interaktywne lekcje"}),m.jsx(le,{text:"Wyzwania i gry"}),m.jsx(le,{text:"Śledzenie postępów"}),m.jsx(le,{text:"Społeczność"})]}),de=()=>m.jsxs("div",{className:"text-center md:text-left max-w-xl",children:[m.jsxs("h1",{className:"text-3xl md:text-4xl lg:text-5xl font-bold text-white mb-6",children:["Odkryj ",m.jsx("span",{className:"text-[#f7df1e]",children:"JavaScript"})," w nowy sposób"]}),m.jsx("p",{className:"text-lg md:text-xl text-gray-300 mb-8",children:"Ucz się, programuj i baw się jednocześnie. Nasza platforma łączy teorię z praktyką, oferując interaktywne lekcje, wyzwania i gry."}),m.jsx(ce,{})]}),ue=()=>m.jsxs(K.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5,delay:.2},className:"w-full md:w-3/5 flex flex-col md:flex-row items-center gap-6 md:gap-12 pr-0 md:pr-8",children:[m.jsx(ie,{}),m.jsx(de,{})]}),me=({activeTab:e,onTabChange:s})=>m.jsxs("div",{className:"flex items-center justify-center gap-4 mb-8",children:[m.jsx(pe,{isActive:"login"===e,onClick:()=>s("login"),icon:m.jsx(p,{}),label:"Logowanie"}),m.jsx(pe,{isActive:"register"===e,onClick:()=>s("register"),icon:m.jsx(w,{}),label:"Rejestracja"}),m.jsx(pe,{isActive:"forgot"===e,onClick:()=>s("forgot"),icon:m.jsx(h,{}),label:"Reset hasła"})]}),pe=({isActive:e,onClick:s,icon:t,label:r})=>m.jsxs(K.button,{whileHover:{scale:1.05},whileTap:{scale:.95},onClick:s,className:"flex flex-col items-center gap-2 p-3 rounded-lg transition-colors "+(e?"bg-js/20 text-js":"text-gray-400 hover:text-js"),children:[t,m.jsx("span",{className:"text-sm font-medium",children:r})]}),we=d.lazy((()=>se((()=>Promise.resolve().then((()=>Le))),void 0))),he=d.lazy((()=>se((()=>Promise.resolve().then((()=>Te))),void 0))),je=d.lazy((()=>se((()=>Promise.resolve().then((()=>We))),void 0))),ge=()=>{const[e,s]=d.useState("login");return m.jsxs(K.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},className:"w-full max-w-md bg-dark/30 backdrop-blur-xl rounded-2xl p-8 border border-js/20 shadow-xl shadow-black/20",role:"main","aria-label":"Formularz autoryzacji",children:[m.jsxs("div",{className:"flex flex-col justify-center items-center mb-6",children:[m.jsx("span",{className:"block text-2xl bg-[#f7df1e] text-black px-2 py-1 rounded",children:"JS"}),m.jsx("h2",{className:"mt-2 text-xl font-bold text-js",children:"CodeLinesJS"})]}),m.jsxs("h1",{className:"text-2xl md:text-3xl font-bold text-center text-js mb-6",children:["login"===e&&"Zaloguj się","register"===e&&"Dołącz do nas","forgot"===e&&"Odzyskaj hasło"]}),m.jsx(me,{activeTab:e,onTabChange:s}),m.jsx(d.Suspense,{fallback:m.jsx("div",{className:"text-center py-4",children:"Ładowanie..."}),children:m.jsxs(Q,{mode:"wait",children:["login"===e&&m.jsx(we,{},"login"),"register"===e&&m.jsx(he,{},"register"),"forgot"===e&&m.jsx(je,{},"forgot")]})}),m.jsx("div",{className:"mt-6 text-center text-sm text-gray-400",children:m.jsxs("p",{children:["Logując się, akceptujesz"," ",m.jsx(j,{to:"/polityka-prywatnosci",className:"text-js hover:underline",children:"Politykę Prywatności"}),"."]})})]})},xe=({children:e,title:s,subtitle:t})=>m.jsxs("div",{className:"w-full md:w-2/5 flex justify-center md:justify-end relative mt-12 md:mt-0",children:[m.jsx("div",{className:"absolute -z-10 top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 w-64 h-64 bg-[#f7df1e]/10 rounded-full blur-3xl"}),e?m.jsxs("div",{className:"w-full max-w-md bg-dark/30 backdrop-blur-xl rounded-2xl p-8 border border-js/20",children:[m.jsxs("div",{className:"flex flex-col justify-center items-center mb-8",children:[m.jsx("span",{className:"block text-2xl bg-[#f7df1e] text-black px-2 py-1 rounded",children:"JS"}),m.jsx("h2",{className:"mt-2 text-xl font-bold text-js",children:"CodeLinesJS"})]}),s&&m.jsx("h1",{className:"text-3xl font-bold text-center text-js mb-4",children:s}),t&&m.jsx("p",{className:"text-center text-gray-400 mb-8",children:t}),e]}):m.jsx(ge,{})]}),ye=({children:e,title:s,subtitle:t}={})=>m.jsxs("main",{className:"min-h-screen w-full relative bg-gradient-to-b from-[#1a1a1a] via-[#242424] to-[#1a1a1a] flex items-center justify-center py-16 overflow-hidden",children:[m.jsxs(g,{children:[m.jsx("title",{children:" Logowanie | CodeLinesJS"}),m.jsx("meta",{name:"description",content:"Logowanie do platformy CodeLinesJS - dołącz do nas i rozwijaj swoje umiejętności w przyjaznym środowisku."})]}),m.jsx(I,{className:"relative z-10",children:m.jsxs("div",{className:"flex flex-col md:flex-row items-center justify-between gap-8 md:gap-20 w-full max-w-7xl mx-auto",children:[m.jsx(ue,{}),m.jsx(C,{children:m.jsx(xe,{children:e,title:s,subtitle:t})})]})}),m.jsx(ne,{})]}),fe=()=>{const[e,s]=d.useState(!1);return{isVisible:e,toggleVisibility:()=>s((e=>!e)),inputType:e?"text":"password"}},be=({errorMessage:e})=>m.jsxs(K.div,{initial:{opacity:0},animate:{opacity:1},className:"space-y-6",children:[m.jsxs("div",{className:"p-4 bg-red-500/10 border border-red-500/20 rounded-lg text-red-400 text-sm flex items-start",children:[m.jsx(x,{className:"mr-2 mt-0.5 flex-shrink-0"}),m.jsxs("div",{children:[m.jsx("p",{className:"font-semibold mb-1",children:"Błąd tokenu resetowania hasła"}),m.jsx("p",{children:e||"Nieprawidłowy lub wygasły token resetowania hasła. Sprawdź, czy link jest poprawny lub spróbuj ponownie zresetować hasło."})]})]}),m.jsxs("div",{className:"text-center mt-6",children:[m.jsx("p",{className:"text-gray-400 mb-4",children:"Możesz spróbować ponownie zresetować hasło:"}),m.jsx(j,{to:"/logowanie",className:"text-js hover:underline",children:"Wróć do strony logowania"})]})]}),ve=({message:e})=>e?m.jsxs(m.Fragment,{children:[m.jsx(A,{message:e,title:"Hasło zostało zmienione"}),m.jsxs("div",{className:"text-center mt-4",children:[m.jsx("p",{className:"text-gray-400 mb-2",children:"Za chwilę zostaniesz przekierowany do strony logowania."}),m.jsx(j,{to:"/logowanie",className:"text-js hover:underline",children:"Przejdź do logowania"})]})]}):null,ke=X.object({email:X.string().min(1,"Email jest wymagany").email("Nieprawidłowy format email"),password:X.string().min(1,"Hasło jest wymagane"),rememberMe:X.boolean().optional()}),ze=X.object({username:X.string().min(3,"Nazwa użytkownika musi mieć minimum 3 znaki").max(20,"Nazwa użytkownika nie może przekraczać 20 znaków").regex(/^[a-zA-Z0-9_]+$/,"Nazwa użytkownika może zawierać tylko litery, cyfry i podkreślenia"),email:X.string().email("Nieprawidłowy format adresu email"),password:X.string().min(8,"Hasło musi mieć minimum 8 znaków").regex(/[A-Z]/,"Hasło musi zawierać przynajmniej jedną wielką literę").regex(/[a-z]/,"Hasło musi zawierać przynajmniej jedną małą literę").regex(/[0-9]/,"Hasło musi zawierać przynajmniej jedną cyfrę"),confirmPassword:X.string(),acceptPrivacy:X.boolean().refine((e=>!0===e),{message:"Musisz zaakceptować politykę prywatności"})}).refine((e=>e.password===e.confirmPassword),{message:"Hasła muszą być identyczne",path:["confirmPassword"]}),Se=X.object({email:X.string().min(1,"Email jest wymagany").email("Nieprawidłowy format email")}),Ne=X.object({password:X.string().min(8,"Hasło musi mieć minimum 8 znaków").regex(/[A-Z]/,"Hasło musi zawierać przynajmniej jedną wielką literę").regex(/[a-z]/,"Hasło musi zawierać przynajmniej jedną małą literę").regex(/[0-9]/,"Hasło musi zawierać przynajmniej jedną cyfrę"),confirmPassword:X.string()}).refine((e=>e.password===e.confirmPassword),{message:"Hasła muszą być identyczne",path:["confirmPassword"]}),Ee=({initialError:e=null,resetOnSuccess:s=!0,showToasts:t=!0}={})=>{const[r,a]=d.useState(null),[o,n]=d.useState(e);d.useEffect((()=>{null!=e&&n(e)}),[e]);const i=d.useCallback((e=>{a(e),n(null),t&&y.success(e),s&&setTimeout((()=>{a(null)}),5e3)}),[s,t]),l=d.useCallback((e=>{n(e),a(null),t&&y.error(e)}),[t]),c=d.useCallback((e=>{var s;let t="";if(e instanceof Error)t=e.message;else if("string"==typeof e)t=e;else if(e&&"object"==typeof e){const r=e;t=r.message||r.error||r.errors&&(null==(s=r.errors[0])?void 0:s.message)||"Wystąpił nieznany błąd. Spróbuj ponownie później."}else t="Wystąpił nieznany błąd. Spróbuj ponownie później.";return l(t),t}),[l]),u=d.useCallback((()=>{a(null),n(null)}),[]);return{successMessage:r,errorMessage:o,setSuccess:i,setError:l,handleError:c,resetStatus:u,hasSuccess:!!r,hasError:!!o}},Pe=()=>{var e,s;const{register:t,errors:r,loading:a,handleSubmit:o,errorMessage:n,successMessage:l,tokenError:u}=(()=>{const{token:e}=f(),{resetPassword:s,loading:t,error:r}=oe(),a=Ee({initialError:r}),[o,n]=d.useState(!1),{register:l,handleSubmit:u,formState:{errors:m},reset:p}=b({resolver:Y(Ne),mode:"onSubmit"});return d.useEffect((()=>{e?e.length<10&&(n(!0),a.setError("Token resetowania hasła jest nieprawidłowy. Sprawdź, czy link jest poprawny.")):(n(!0),a.setError("Brak tokenu resetowania hasła. Sprawdź, czy link jest poprawny."))}),[e,a]),i({register:l,errors:m,loading:t,tokenError:o,handleSubmit:u((t=>c(void 0,null,(function*(){if(e)try{a.resetStatus();const r=yield s(e,t.password,t.confirmPassword);a.setSuccess(r),p()}catch(r){const e=a.handleError(r);"string"==typeof e&&(e.includes("token")||e.includes("Token")||e.includes("wygasł"))&&n(!0)}else a.setError("Brak tokenu resetowania hasła. Sprawdź, czy link jest poprawny.")}))))},a)})();return u?m.jsx(be,{errorMessage:n}):m.jsxs(L,{onSubmit:o,children:[n&&m.jsx(_,{message:n,title:"Błąd resetowania hasła"}),m.jsx(ve,{message:l}),!l&&m.jsxs(m.Fragment,{children:[m.jsx("p",{className:"text-gray-400 text-sm mb-6",children:"Wprowadź nowe hasło dla swojego konta. Hasło musi zawierać co najmniej 8 znaków, w tym jedną wielką literę, jedną małą literę i jedną cyfrę."}),m.jsx(O,i({label:"Nowe hasło",error:null==(e=r.password)?void 0:e.message},t("password"))),m.jsx(O,i({label:"Potwierdź nowe hasło",error:null==(s=r.confirmPassword)?void 0:s.message},t("confirmPassword"))),m.jsx(T,{type:"submit",className:"w-full",disabled:a,children:a?"Resetowanie hasła...":"Zresetuj hasło"})]})]})},Me=()=>m.jsxs(K.div,{initial:{opacity:0},animate:{opacity:1},className:"space-y-6",children:[m.jsxs("div",{className:"p-4 bg-red-500/10 border border-red-500/20 rounded-lg text-red-400 text-sm flex items-start",children:[m.jsx(x,{className:"mr-2 mt-0.5 flex-shrink-0"}),m.jsxs("div",{children:[m.jsx("p",{className:"font-semibold mb-1",children:"Błąd tokenu resetowania hasła"}),m.jsx("p",{children:"Nieprawidłowy lub wygasły token resetowania hasła. Sprawdź, czy link jest poprawny lub spróbuj ponownie zresetować hasło."})]})]}),m.jsxs("div",{className:"text-center mt-6",children:[m.jsx("p",{className:"text-gray-400 mb-4",children:"Możesz spróbować ponownie zresetować hasło na stronie logowania:"}),m.jsxs(j,{to:"/logowanie",className:"inline-flex items-center text-js hover:underline",children:[m.jsx(v,{className:"mr-2"})," Wróć do strony logowania"]})]})]}),Ie=Object.freeze(Object.defineProperty({__proto__:null,ResetPasswordPage:()=>{const{token:e}=f();return e?m.jsx(ye,{title:"Resetowanie hasła",subtitle:"Wprowadź nowe hasło dla swojego konta",children:m.jsx(Pe,{})}):m.jsx(ye,{title:"Nieprawidłowy link",subtitle:"Link do resetowania hasła jest nieprawidłowy lub wygasł.",children:m.jsx(Me,{})})}},Symbol.toStringTag,{value:"Module"})),Ce=d.memo((({rememberMe:e})=>{const{loginWithGoogle:s}=oe(),[t,r]=d.useState(null);return m.jsxs(m.Fragment,{children:[t&&m.jsx("div",{className:"mb-4 p-3 rounded-lg bg-red-500/10 border border-red-500/20 text-red-400 text-sm",children:t}),m.jsx("div",{className:"flex flex-col items-center",children:m.jsx(k,{onSuccess:t=>{s(t,e)},onError:()=>{r("Logowanie przez Google nie powiodło się. Spróbuj ponownie później.")},theme:"filled_black",shape:"pill",text:"continue_with",locale:"pl",useOneTap:!1,context:"signin",type:"standard",size:"large",width:"100%"})})]})}));Ce.displayName="GoogleLoginButton";const Ae=d.memo((({register:e})=>m.jsx("div",{className:"flex items-center",children:m.jsxs("label",{className:"flex items-center gap-2 cursor-pointer group",children:[m.jsxs("div",{className:"relative",children:[m.jsx("input",i({type:"checkbox",className:"peer sr-only"},e("rememberMe"))),m.jsx("div",{className:"w-4 h-4 border border-js/30 rounded bg-dark/70 peer-checked:bg-js peer-checked:border-js transition-colors"}),m.jsx("div",{className:"absolute inset-0 flex items-center justify-center text-black scale-0 peer-checked:scale-100 transition-transform",children:m.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-3 w-3",viewBox:"0 0 20 20",fill:"currentColor",children:m.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})})})]}),m.jsx("span",{className:"text-sm text-gray-400 group-hover:text-gray-300 transition-colors",children:"Zapamiętaj mnie"})]})})));Ae.displayName="RememberMeCheckbox";const Le=Object.freeze(Object.defineProperty({__proto__:null,default:()=>{var e,s;const{login:t,loading:r,error:a}=oe(),{register:o,handleSubmit:n,formState:{errors:u},watch:p}=b({resolver:Y(ke),mode:"onSubmit"}),w=p("rememberMe",!1)||!1,[h,j]=d.useState(!1);return m.jsxs(K.form,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},onSubmit:n((e=>c(void 0,null,(function*(){yield t(e.email,e.password,e.rememberMe)})))),className:"space-y-5",children:[a&&m.jsx(W,{message:a,withIcon:!0,variant:"standard"}),m.jsx(B,i({type:"email",label:"Email",placeholder:"twoj@email.com",icon:m.jsx(z,{}),error:null==(e=u.email)?void 0:e.message},o("email"))),m.jsx(B,l(i({type:h?"text":"password",label:"Hasło",placeholder:"••••••••",icon:m.jsx(S,{}),error:null==(s=u.password)?void 0:s.message},o("password")),{rightIcon:m.jsx("button",{type:"button",onClick:()=>j(!h),className:"focus:outline-none text-gray-400 hover:text-js transition-colors",children:h?m.jsx(N,{}):m.jsx(E,{})})})),m.jsx("div",{className:"flex items-center justify-between",children:m.jsx(Ae,{register:o})}),m.jsx("div",{className:"pt-2",children:m.jsx(H,{isLoading:r,loadingText:"Logowanie...",children:"Zaloguj się"})}),m.jsxs("div",{className:"relative flex items-center justify-center my-4",children:[m.jsx("div",{className:"border-t border-gray-600 w-full"}),m.jsx("span",{className:"bg-dark/50 px-3 text-sm text-gray-400 absolute",children:"lub"})]}),m.jsx(Ce,{rememberMe:w})]})}},Symbol.toStringTag,{value:"Module"})),_e=d.memo((({register:e,error:s})=>m.jsxs("div",{className:"space-y-1",children:[m.jsxs("label",{className:"flex items-start gap-2 cursor-pointer group",children:[m.jsx("input",i({type:"checkbox",className:`\n          mt-1 w-4 h-4 rounded bg-dark text-js \n          transition-colors duration-200 ease-in-out\n          ${s?"border-red-500 focus:ring-red-500/20":"border-js/20 focus:ring-js/20 hover:border-js/30"}\n        `},e)),m.jsxs("span",{className:"text-sm text-gray-400 group-hover:text-gray-300 transition-colors",children:["Akceptuję"," ",m.jsx(j,{to:"/polityka-prywatnosci",className:"text-js hover:text-js/80 underline transition-colors",target:"_blank",rel:"noopener noreferrer",children:"politykę prywatności"})]})]}),s&&m.jsx(K.p,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},className:"text-sm text-red-400",children:s})]})));_e.displayName="PrivacyPolicyCheckbox";const Oe=()=>{const{register:e,loading:s,error:t}=oe(),[r,a]=d.useState(!1),[o,n]=d.useState(null),u=(({schema:e,defaultValues:s,mode:r="onSubmit",resetOnSuccess:a=!0,onSuccess:o,onError:n})=>{const[u,m]=d.useState(!1),p=Ee({resetOnSuccess:a}),w=b({resolver:Y(e),defaultValues:s,mode:r}),h=d.useCallback((e=>c(void 0,null,(function*(){try{m(!0),p.resetStatus(),o&&(yield o(e))}catch(t){p.handleError(t),n&&n(t)}finally{m(!1)}}))),[o,n,p]),j=d.useCallback((e=>{h(e)}),[h]),g=d.useCallback((e=>{p.setError("Formularz zawiera błędy. Sprawdź wprowadzone dane.")}),[p]),x=w.handleSubmit(j,g);return l(i({},w),{isSubmitting:u,errorMessage:p.errorMessage,successMessage:p.successMessage,onFormSubmit:x,handleSubmitWithValidation:h})})({schema:ze,mode:"onChange",defaultValues:{acceptPrivacy:!1},onSuccess(s){return c(this,null,(function*(){try{a(!0),n(null),yield e(s.email,s.password,s.username)}catch(t){const e=t instanceof Error?t.message:"Wystąpił błąd podczas rejestracji";n(e)}finally{a(!1)}}))}});return d.useEffect((()=>{t&&n(t)}),[t]),{register:u.register,errors:u.formState.errors,loading:s||r||u.isSubmitting,handleSubmit:u.onFormSubmit,errorMessage:o||t||u.errorMessage,successMessage:u.successMessage}},Te=Object.freeze(Object.defineProperty({__proto__:null,default:()=>{var e,s,t,r,a;const{register:o,errors:n,loading:l,handleSubmit:c,errorMessage:d}=Oe();return m.jsxs(L,{onSubmit:c,children:[d&&m.jsx(W,{message:d,variant:"alert",title:"Błąd rejestracji",className:"mb-6 text-base border-2"}),m.jsx(B,i({type:"text",label:"Nazwa użytkownika",placeholder:"jankowalski",icon:m.jsx(P,{}),error:null==(e=n.username)?void 0:e.message},o("username"))),m.jsx(B,i({type:"email",label:"Email",placeholder:"twoj@email.com",icon:m.jsx(z,{}),error:null==(s=n.email)?void 0:s.message},o("email"))),m.jsx(O,i({label:"Hasło",error:null==(t=n.password)?void 0:t.message},o("password"))),m.jsx(O,i({label:"Potwierdź hasło",error:null==(r=n.confirmPassword)?void 0:r.message},o("confirmPassword"))),m.jsx(_e,{register:o("acceptPrivacy"),error:null==(a=n.acceptPrivacy)?void 0:a.message}),m.jsx(H,{isLoading:l,loadingText:"Rejestracja...",children:"Zarejestruj się"}),d&&m.jsx("div",{className:"mt-4",children:m.jsx(W,{message:d,withIcon:!0,className:"text-sm"})})]})}},Symbol.toStringTag,{value:"Module"})),We=Object.freeze(Object.defineProperty({__proto__:null,default:()=>{var e;const{register:s,errors:t,loading:r,handleSubmit:a,errorMessage:o,successMessage:n}=(()=>{const{forgotPassword:e,loading:s,error:t}=oe(),r=Ee({initialError:t}),{register:a,handleSubmit:o,reset:n,formState:{errors:l}}=b({resolver:Y(Se)});return i({register:a,errors:l,loading:s,handleSubmit:o((s=>c(void 0,null,(function*(){try{r.resetStatus();const t=yield e(s.email);r.setSuccess(t),n()}catch(t){r.handleError(t)}}))))},r)})();return m.jsxs(L,{onSubmit:a,children:[o&&m.jsx(_,{message:o,title:"Błąd resetowania hasła"}),n&&m.jsx(A,{message:n}),!n&&m.jsxs(m.Fragment,{children:[m.jsx("p",{className:"text-gray-400 text-sm mb-6",children:"Podaj swój adres email, a wyślemy Ci link do zresetowania hasła."}),m.jsx(B,i({type:"email",label:"Email",placeholder:"twoj@email.com",icon:m.jsx(z,{}),error:null==(e=t.email)?void 0:e.message},s("email"))),m.jsx(T,{type:"submit",className:"w-full",disabled:r,children:r?"Wysyłanie...":"Wyślij link resetujący"})]})]})}},Symbol.toStringTag,{value:"Module"}));export{te as A,se as _,fe as a,ye as b,Ie as i,oe as u};
